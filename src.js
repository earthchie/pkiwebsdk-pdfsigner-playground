require("pkiwebsdk");

// Set your own CA store
const rootCA = `-----BEGIN CERTIFICATE-----
MIIGETCCA/mgAwIBAgIUR05NEP21Ye0y73g2QPikYfB9jAMwDQYJKoZIhvcNAQEL
BQAwgY8xCzAJBgNVBAYTAklEMRAwDgYDVQQIDAdqYWthcnRhMRAwDgYDVQQHDAdq
YWthcnRhMRAwDgYDVQQKDAdtYXNjZW5nMRAwDgYDVQQLDAdtYXNjZW5nMRYwFAYD
VQQDDA1tYWNzZW5nUm9vdENBMSAwHgYJKoZIhvcNAQkBFhFyb290Y2FAbWFzY2Vu
Zy5pZDAeFw0yMDA5MjIxNjA2MzBaFw00MDA5MTcxNjA2MzBaMIGPMQswCQYDVQQG
EwJJRDEQMA4GA1UECAwHamFrYXJ0YTEQMA4GA1UEBwwHamFrYXJ0YTEQMA4GA1UE
CgwHbWFzY2VuZzEQMA4GA1UECwwHbWFzY2VuZzEWMBQGA1UEAwwNbWFjc2VuZ1Jv
b3RDQTEgMB4GCSqGSIb3DQEJARYRcm9vdGNhQG1hc2NlbmcuaWQwggIiMA0GCSqG
SIb3DQEBAQUAA4ICDwAwggIKAoICAQDFfhmsuqEsUE0XD5wB0DO7E0IN5SzXVDoq
RDxrJj9V8HYWmECRFhDcDqnpY9yZffsXaiYcmGhT3WODflm7rqDe7npYLCwt2nOr
pEraXX633VRk3k0d2/s84JZ9PKn6p2oyF9Ei/FboL+8FaRbZPYBvHABafqYH0HVU
q8+3IMQWPCreV5zQO85Xm3HUjP5lGIu3NTHThCP2Se9m1tW/wnx9QexxQSOswhrw
PZd5s8sJ9uvgjNg0NEyLYmzXSyhJAqtFhfSnMLpXPhzkAbJuTMRF2nvo7iEzy0Ki
6pcEuG7f7NQavdbeCgDubcxE4PICoW6tzYLx86fGx0PZOvqSNF3nuGABwdzh9QHR
jAc4cFe3huc03rcu1RXlfbzpeddSTVxCUrS1bMLIYzL5yZO8mXwS/cNLWINMwCiR
Y0BEawlUcuC8/521LCiZ7iluAUFkiqSVMEybtESRhAiFx3YS/na9hCdOIboMgkzC
TPIrBhxW6DeLyu27WI1cnJ4Fxn19m4ppY8nTx8PBxNPbQN6lyPBzPbCrULWK4fl7
pA1VfVxm6V7WETQ5mLSTSJfz6kJpilyYBvXvcqM8P24DqD3IcqgUtVfaPGIuUA/z
O6edtIRU9qT70DMpDMC/5KQWUnejs42Me5+QH7WLHDtiToaunw7ufyAjnq+HEKfX
uaaoZE/T8QIDAQABo2MwYTAdBgNVHQ4EFgQUVpnuF9DMLcTQMVT+SrjU7KVCSogw
HwYDVR0jBBgwFoAUVpnuF9DMLcTQMVT+SrjU7KVCSogwDwYDVR0TAQH/BAUwAwEB
/zAOBgNVHQ8BAf8EBAMCAYYwDQYJKoZIhvcNAQELBQADggIBALPMPbDyw5NyKivw
HlaIAvzHYn9o7bIWgcMsVAkR1FLI44p/tVnpxDln1ncvBwbW9nepf2KZxpqKMLdH
TA6W6MGWF3DXpfM45RWjz2P4l2gQAq7ATK9uKmKxH1DbvzvSiAThiiFJKLi92ip+
Rd/HK7gWI4OkG8WmjV2W9VwjKo17BHg6v0wb+eITpBkvfq2CqzFIEKPsVllVnI3A
6EtxzT9G+x09roAjGCfnaqMsB38aYZZQPdmIJgl5CWKx8MzT77lCvorllwgw0Fur
F+bmqKiOAjKpCQLsLwEtHi9HVhSya+yGH917lpdeg+8kEdbuJbGBr/EfAhcwmopc
fG9GJhGIaQH7Njt05OS+cs5hr7fhBb/hjnM9kGG5pnDmyt2mgo1GV8yqSZrviNz1
et/WKb6YSV2Q0ULmc+qvQbj7TiK2LEX7J0aIJw2FGCPAQLq3zlv8u/fKdfWT0o1A
nEhOYscAiRIWdKm7J2x7c6eqG60ZRo8o+NjJdRrFWXmxySRR+ig83R+XT6NAeEHL
PgCawTw1LmVNVX3Tv+1XrJ4f4CSTCFaq4sCpKhnIPJapdiKnuHxBjYbAB/poOwFY
LYKgrg4LXu4edyew/aH4pgQY7nVOmj8xLl9/dXHjQviFPIuYc/2gv/ujYBRFs5rS
pMVPHlxSyhOMfGjhuZNFH6bxUHTE
-----END CERTIFICATE-----`;
const intermediateCA = `-----BEGIN CERTIFICATE-----
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
IVohhQ==
-----END CERTIFICATE-----`;
window.PKIWebSDK.setCaStore([rootCA, intermediateCA]);

window.signPDF = function(passphrase, p12, data, cb) {
  const cert = new PKIWebSDK.Certificate();
  var certificate = null;
  var privateKey = null;
  cert
    .parseP12(p12, passphrase)
    .then(result => {
      certificate = result.certificate;
      return PKIWebSDK.Key.parsePEM(result.privateKey, "SHA-256");
    })
    .then(key => {
      privateKey = key;
      return certificate.getSubject();
    })
    .then(subject => {
      pdf = new PKIWebSDK.PDF(new Uint8Array(data));
      var info = {
        name: subject.commonName,
        reason: "",
        location: subject.stateOrProvinceName,
        contactInfo: subject.emailAddress
      };
      return pdf.sign(certificate, privateKey, info);
    })
    .then(result => {
      cb(null, result); //ab2Base64(result));
    })
    .catch(err => {
      cb(err.message);
    });
};

window.verifyPDF = function(data, cb) {
  let pdf = new PKIWebSDK.PDF(new Uint8Array(data));
  pdf
    .getSignatures()
    .then(result => {
      cb(result, result);
    })
    .catch(err => {
      cb(err.message);
    });
};

let budiP12 = window.PKIWebSDK.Utils.base642Ab(
  "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"
);

let asepP12 = window.PKIWebSDK.Utils.base642Ab("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")

let pdf = window.PKIWebSDK.Utils.base642Ab(
  "JVBERi0xLjYNJeLjz9MNCjI0IDAgb2JqDTw8L0ZpbHRlci9GbGF0ZURlY29kZS9GaXJzdCA0L0xlbmd0aCAyMTYvTiAxL1R5cGUvT2JqU3RtPj5zdHJlYW0NCmjePI9RS8MwFIX/yn1bi9jepCQ6GYNpFBTEMsW97CVLbjWYNpImmz/fVsXXcw/f/c4SEFarepPTe4iFok8dU09DgtDBQx6TMwT74vaLTE7uSPDUdXM0Xe/73r1FnVwYYEtHR6d9WdY3kX4ipRMV6oojSmxQMoGyac5RLBAXf63p38aGA7XPorLewyvFcYaJile8rB+D/YcwiRdMMGScszO8/IW0MdhsaKKYGA46gXKTr/cUQVY4We/cYMNpnLVeXPJUXHs9fECr7kAFk+eZ5Xr9LcAAfKpQrA0KZW5kc3RyZWFtDWVuZG9iag0yNSAwIG9iag08PC9GaWx0ZXIvRmxhdGVEZWNvZGUvRmlyc3QgNC9MZW5ndGggNDkvTiAxL1R5cGUvT2JqU3RtPj5zdHJlYW0NCmjeslAwULCx0XfOL80rUTDU985MKY42NAIKBsXqh1QWpOoHJKanFtvZAQQYAN/6C60NCmVuZHN0cmVhbQ1lbmRvYmoNMjYgMCBvYmoNPDwvRmlsdGVyL0ZsYXRlRGVjb2RlL0ZpcnN0IDkvTGVuZ3RoIDQyL04gMi9UeXBlL09ialN0bT4+c3RyZWFtDQpo3jJTMFAwVzC0ULCx0fcrzS2OBnENFIJi7eyAIsH6LnZ2AAEGAI2FCDcNCmVuZHN0cmVhbQ1lbmRvYmoNMjcgMCBvYmoNPDwvRmlsdGVyL0ZsYXRlRGVjb2RlL0ZpcnN0IDUvTGVuZ3RoIDEyMC9OIDEvVHlwZS9PYmpTdG0+PnN0cmVhbQ0KaN4yNFIwULCx0XfOzytJzSspVjAyBgoE6TsX5Rc45VdEGwB5ZoZGCuaWRrH6vqkpmYkYogGJRUCdChZgfUGpxfmlRcmpxUAzA4ryk4NTS6L1A1zc9ENSK0pi7ez0g/JLEktSFQz0QyoLUoF601Pt7AACDADYoCeWDQplbmRzdHJlYW0NZW5kb2JqDTIgMCBvYmoNPDwvTGVuZ3RoIDM1MjUvU3VidHlwZS9YTUwvVHlwZS9NZXRhZGF0YT4+c3RyZWFtDQo8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjQtYzAwNSA3OC4xNDczMjYsIDIwMTIvMDgvMjMtMTM6MDM6MDMgICAgICAgICI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnBkZj0iaHR0cDovL25zLmFkb2JlLmNvbS9wZGYvMS4zLyIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIj4KICAgICAgICAgPHBkZjpQcm9kdWNlcj5BY3JvYmF0IERpc3RpbGxlciA2LjAgKFdpbmRvd3MpPC9wZGY6UHJvZHVjZXI+CiAgICAgICAgIDx4bXA6Q3JlYXRlRGF0ZT4yMDA2LTAzLTA2VDE1OjA2OjMzLTA1OjAwPC94bXA6Q3JlYXRlRGF0ZT4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZVBTNS5kbGwgVmVyc2lvbiA1LjIuMjwveG1wOkNyZWF0b3JUb29sPgogICAgICAgICA8eG1wOk1vZGlmeURhdGU+MjAxNi0wNy0xNVQxMDoxMjoyMSswODowMDwveG1wOk1vZGlmeURhdGU+CiAgICAgICAgIDx4bXA6TWV0YWRhdGFEYXRlPjIwMTYtMDctMTVUMTA6MTI6MjErMDg6MDA8L3htcDpNZXRhZGF0YURhdGU+CiAgICAgICAgIDx4bXBNTTpEb2N1bWVudElEPnV1aWQ6ZmYzZGNmZDEtMjNmYS00NzZmLTgzOWEtM2U1Y2FlMmRhMmViPC94bXBNTTpEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD51dWlkOjM1OTM1MGIzLWFmNDAtNGQ4YS05ZDZjLTAzMTg2YjRmZmIzNjwveG1wTU06SW5zdGFuY2VJRD4KICAgICAgICAgPGRjOmZvcm1hdD5hcHBsaWNhdGlvbi9wZGY8L2RjOmZvcm1hdD4KICAgICAgICAgPGRjOnRpdGxlPgogICAgICAgICAgICA8cmRmOkFsdD4KICAgICAgICAgICAgICAgPHJkZjpsaSB4bWw6bGFuZz0ieC1kZWZhdWx0Ij5CbGFuayBQREYgRG9jdW1lbnQ8L3JkZjpsaT4KICAgICAgICAgICAgPC9yZGY6QWx0PgogICAgICAgICA8L2RjOnRpdGxlPgogICAgICAgICA8ZGM6Y3JlYXRvcj4KICAgICAgICAgICAgPHJkZjpTZXE+CiAgICAgICAgICAgICAgIDxyZGY6bGk+RGVwYXJ0bWVudCBvZiBKdXN0aWNlIChFeGVjdXRpdmUgT2ZmaWNlIG9mIEltbWlncmF0aW9uIFJldmlldyk8L3JkZjpsaT4KICAgICAgICAgICAgPC9yZGY6U2VxPgogICAgICAgICA8L2RjOmNyZWF0b3I+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz4NCmVuZHN0cmVhbQ1lbmRvYmoNMTEgMCBvYmoNPDwvTWV0YWRhdGEgMiAwIFIvUGFnZUxhYmVscyA2IDAgUi9QYWdlcyA4IDAgUi9UeXBlL0NhdGFsb2c+Pg1lbmRvYmoNMjMgMCBvYmoNPDwvRmlsdGVyL0ZsYXRlRGVjb2RlL0xlbmd0aCAxMD4+c3RyZWFtDQpIiQIIMAAAAAABDQplbmRzdHJlYW0NZW5kb2JqDTI4IDAgb2JqDTw8L0RlY29kZVBhcm1zPDwvQ29sdW1ucyA0L1ByZWRpY3RvciAxMj4+L0ZpbHRlci9GbGF0ZURlY29kZS9JRFs8REI3Nzc1Q0NFMjI3RjZCMzBDNDQwREY0MjIxREMzOTA+PEJGQ0NDRjNGNTdGNjEzNEFCRDNDMDRBOUU0Q0ExMDZFPl0vSW5mbyA5IDAgUi9MZW5ndGggODAvUm9vdCAxMSAwIFIvU2l6ZSAyOS9UeXBlL1hSZWYvV1sxIDIgMV0+PnN0cmVhbQ0KaN5iYgACJjDByGzIwPT/73koF0wwMUiBWYxA4v9/EMHA9I/hBVCxoDOQeH8DxH2KrIMIglFwIpD1vh5IMJqBxPpArHYgwd/KABBgAP8bEC0NCmVuZHN0cmVhbQ1lbmRvYmoNc3RhcnR4cmVmDQo0NTc2DQolJUVPRg0K"
);

window.signPDF("123456", budiP12, pdf, (err, result) => {
  console.log(err);
  // Uncomment to download
  //window.toFile(result)
  window.verifyPDF(result, (err, verifyResult) => {
    console.log(err);
    console.log(verifyResult[0].signedData.getData().signerInfo[0].authenticatedAttributes.digest); // Digest
    console.log(verifyResult[0].signedData.getData().signerInfo[0].serialNumber); // To be check against CRL
    console.log(verifyResult[0].signedData.data.certificates[0].toPEM()); // To be check against CA chain
  });
});

window.toFile = (arrayBuffer, filename, type) => {
  var blob = new Blob([arrayBuffer], { type: type });
  if (typeof window.navigator.msSaveBlob !== "undefined") {
    window.navigator.msSaveBlob(blob, filename);
  } else {
    var URL = window.URL || window.webkitURL;
    var downloadUrl = URL.createObjectURL(blob);
    if (filename) {
      var a = document.createElement("a");
      if (typeof a.download === "undefined") {
        window.location = downloadUrl;
      } else {
        a.href = downloadUrl;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
      }
    } else {
      window.location = downloadUrl;
    }
    setTimeout(function() {
      URL.revokeObjectURL(downloadUrl);
    }, 100);
  }
};
